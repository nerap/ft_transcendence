<div id="user-profile">
    <img src="<%= user.avatar %>">
    <h1><%= user.username %>'s profile</h1>
    <div class="edit-current-user">
        <% if (user.id == Transcendence.current_user.id) { %>
            <a href="/users/edit"><button>Edit account</button></a>
            <a href="/#users/<%= user.id %>/edit_profile"><button>Edit profile</button></a>
        <% } else { %>
            <table style="margin:auto;">
                <tr>
                    <td><button>Add friend</button></td>
                    <td>
                        <% if (Transcendence.current_user.toJSON().block_list.includes(user.id)) { %>
                            <% var action = "unblock" %>
                        <% } else { %>
                            <% var action = "block" %>
                        <% } %>
                        <form action="/api/users/<%= action %>_user" method="post" data-remote="true">
                            <input type="hidden" name="_method" value="put">
                            <button type="submit" class="menu-option <%= action %>"><%= action %></button>
                            <input value="<%= user.id %>" type="hidden" name="user[id]">
                            <input type="hidden" name="authenticity_token" value="<%= $(`meta[name='csrf-token']`).attr('content') %>">
                        </form>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <form action="/api/private_rooms" method="post" data-remote="true" id="send-pm"
                            class="<%= user.id %>">
                            <button type="submit" class="menu-option">send PM</button>
                            <input value="<%= Transcendence.current_user.id %>" type="hidden" name="private_room[user1]">
                            <input value="<%= user.id %>" type="hidden" name="private_room[user2]">
                            <input type="hidden" name="authenticity_token"
                                value="<%= $(`meta[name='csrf-token']`).attr('content') %>">
                        </form>
                    </td>
                </tr>
            </table>
        <% } %>
    </div>
</div>
