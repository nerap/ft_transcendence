<div id="main-chatrooms">

  <div>
    <%= link_to new_chatroom_path do %>
      Create a chatroom
    <% end %>
  </div>

  <% if @chatrooms.present? %>
  <% else %>
    <div>
      There are no chatrooms
    </div>
  <% end %>

  <div>
    <ul class="tabs">
      <li class="active"><a href="#public">Public chatrooms</a></li>
      <li><a href="#private">Private chatrooms</a></li>
      <li><a href="#member">My chatrooms</a></li>
    </ul>
    <div class="tabs-content">
      <div class="tab-content active" id="public">
        <table class="tab-content-list">
          <tr>
            <th>NAME</th>
            <th>OWNER</th>
          </tr>
          <% @chatrooms.each do |chatroom| %>
            <% if chatroom.chatroom_type == "public" %>
              <tr class="tab-content-list-options" id="chatroom_<%= chatroom.id %>">
                <td><%= link_to chatroom_path(chatroom), class: "tab-content-list-option-link" do %><div class="tab-content-list-option"><%= chatroom.name %></div><% end %></td>
                <td><%= link_to User.find(chatroom.owner), class: "tab-content-list-option-link" do %><div class="tab-content-list-option"><%= User.find(chatroom.owner).username %></div><% end %></td>
                <td><%= link_to "Destroy", chatroom_path(chatroom), method: :delete, remote: true, data: { confirm: 'Are you sure?' } %></td>
              </tr>
            <% end %>
          <% end %>
        </table>
      </div>
      <div class="tab-content" id="private">
        <table class="tab-content-list">
          <tr class="tab-content-headers">
            <th>NAME</th>
            <th>OWNER</th>
          </tr>
          <% @chatrooms.each do |chatroom| %>
            <% if chatroom.chatroom_type == "private" %>
              <tr class="tab-content-list-options" id="chatroom_<%= chatroom.id %>">
                <% if current_user.id == chatroom.owner || chatroom.members.detect{ |e| e == current_user.id } %>
                  <td><%= link_to chatroom_path(chatroom), class: "tab-content-list-option-link" do %><div class="tab-content-list-option"><%= chatroom.name %></div><% end %></td>
                <% else %>
                  <td><div id="tab-content-list-option-link-room"><div class="tab-content-list-option"><%= chatroom.name %></div></div></td>
                  <!-- Modal -->
                  <%= render "login", chatroom: chatroom %>
                  <!-- End Modal -->
                <% end %>
                <td><%= link_to User.find(chatroom.owner), class: "tab-content-list-option-link" do %><div class="tab-content-list-option"><%= User.find(chatroom.owner).username %></div><% end %></td>
              </tr>
            <% end %>
          <% end %>
        </table>
      </div>
      <div class="tab-content" id="member">
        <table class="tab-content-list">
          <tr class="tab-content-headers">
            <th>NAME</th>
            <th>OWNER</th>
          </tr>
          <% @chatrooms.each do |chatroom| %>
            <% if chatroom.members.detect{ |e| e == current_user.id } || current_user.id == chatroom.owner %>
              <tr class="tab-content-list-options" id="chatroom_<%= chatroom.id %>">
                <td><%= link_to chatroom_path(chatroom), class: "tab-content-list-option-link" do %><div class="tab-content-list-option"><%= chatroom.name %></div><% end %></td>
                <td><%= link_to User.find(chatroom.owner), class: "tab-content-list-option-link" do %><div class="tab-content-list-option"><%= User.find(chatroom.owner).username %></div><% end %></td>
              </tr>
            <% end %>
          <% end %>
        </table>
      </div>
    </div>
  </div>
</div>

<%= javascript_pack_tag 'Chatrooms.js' %>